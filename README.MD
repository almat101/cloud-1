# Cloud-1: Containerized WordPress Stack with Ansible Deployment

A production-ready, containerized WordPress application stack featuring automated SSL certificate management, database administration, and multi-environment deployment using Ansible.

## ğŸ¯ Project Overview

Cloud-1 demonstrates **Infrastructure as Code** principles by combining Docker containerization with Ansible automation to deploy a complete WordPress stack. The project showcases modern DevOps practices including automated SSL certificate management, multi-environment deployment, and secure configuration management.

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Internet                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                â”‚   Nginx   â”‚ (Port 80/443)
                â”‚  Reverse  â”‚ SSL/TLS Termination
                â”‚   Proxy   â”‚ Let's Encrypt + Cloudflare
                â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚WordPress  â”‚ â”‚phpMyAdmin â”‚ â”‚  Certbot  â”‚
  â”‚   (PHP)   â”‚ â”‚   (Admin) â”‚ â”‚   (SSL)   â”‚
  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
                â”‚  MariaDB  â”‚
                â”‚ Database  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Quick Start

### Prerequisites
- Python 3.9+
- SSH access to target servers (for production)
- Cloudflare account with API token (for production SSL)


### Local Testing
- No SSH required for local testing
- Project runs directly on your current machine
- You have to create your own secrets file (vars/secrets_dev.yml) - see [Configuration](#ğŸ”§-configuration)


## ğŸŒŸ Key Features

- **ğŸ³ Containerized Stack**: WordPress, MariaDB, phpMyAdmin, Nginx with Alpine Linux base
- **ğŸ” Automated SSL**: Let's Encrypt certificates with Cloudflare DNS challenge
- **ğŸš€ Multi-Environment**: Separate dev/prod configurations with Ansible
- **ğŸ”’ Security-First**: Vault-encrypted secrets, access controls, security headers
- **âš¡ Zero-Downtime**: Health checks and graceful service management
- **ğŸ“Š Monitoring**: Health endpoints and comprehensive logging

## ğŸ“š Documentation

| Document | Purpose |
|----------|---------|
| **[ğŸ“– Ansible Documentation](ansible_doc.md)** | Complete deployment automation guide |
| **[ğŸ³ Microservices Documentation](containers_doc.md)** | Detailed container architecture and services |


## ğŸ”§ Configuration

### Local Development Setup

```bash
# Clone and setup 
git clone https://github.com/almat101/cloud-1.git
cd cloud-1/ansible
# Source the script to enter in the python virtual environment(this install ansible and all its dependencies)
source ansible_venv.sh
```

### Required Environment Variables

Create a Vault-encrypted file for development environment with the following variables. These will be securely transformed into a `.env` file during deployment:

```bash
# Reomove my vault vars
rm -rf vars/secrets_dev.yml
#Create the vault vars
ansible-vault create vars/secrets_dev.yml

```

Each environment file should contain these variables, customized for your specific deployment:

```yaml
# Core settings
DOMAIN_NAME: "localhost"
CLOUDFLARE_API_TOKEN: "not_required_for_dev"
EMAIL: "dev@localhost"
USER: "ale"

# Database
MARIA_DB: "mariadb"
MARIA_DB_NAME: "wordpress_db"
MARIA_USER: "wp_user"
MARIA_PASSWORD: "dev_password123"
MARIA_ROOT_PASSWORD: "dev_root123"

# WordPress
WP_TITLE: "cloud1-dev"
WP_USER: "dev_user"
WP_PASSWORD: "dev_password"
WP_EMAIL: "dev@localhost"
WP_ROOT_USER: "dev_admin"
WP_ROOT_PASSWORD: "dev_admin_pass"
WP_ROOT_EMAIL: "admin@localhost"

# Access Control (full access for development)
WP_ADMIN_ACCESSIBLE: "true"
PMA_ACCESSIBLE: "true"

# phpMyAdmin
BLOWFISH_SECRET: "dev_secret_32_chars_exactly_123"

# Optional
COMPOSE_BAKE: "true"
```


## ğŸ—ï¸ Project Structure

```
cloud-1/
â”œâ”€â”€ README.md                          # Project overview (this file)
â”œâ”€â”€ ansible_doc.md                     # Ansible deployment guide
â”œâ”€â”€ Container_doc.md                   # Container architecture guide
â”œâ”€â”€ ansible/                           # Deployment automation
â”‚   â”œâ”€â”€ inventory/hosts.ini            # Dev/prod host definitions
â”‚   â”œâ”€â”€ playbooks/deploy.yml           # Main deployment playbook
â”‚   â”œâ”€â”€ roles/                         # Ansible automation roles
â”‚   â””â”€â”€ vars/                          # Encrypted secrets (Vault)
â””â”€â”€ srcs/                              # Container source code
    â”œâ”€â”€ docker-compose.yml             # Service orchestration
    â””â”€â”€ requirements/                  # Service configurations
        â”œâ”€â”€ nginx/                     # Web server & reverse proxy
        â”œâ”€â”€ wordpress/                 # WordPress application
        â”œâ”€â”€ mariadb/                   # Database server
        â”œâ”€â”€ phpmyadmin/               # Database administration
        â””â”€â”€ certbot/                  # SSL certificate management
```

## ğŸ”„ Common Operations

| Task | Command | Requirements |
|------|---------|-------------|
| **Deploy to dev** | `ansible-playbook playbooks/deploy.yml --limit dev --ask-vault-pass --ask-become-pass` | âœ… **Available now** - Local machine only |
| **Deploy to prod** | `ansible-playbook playbooks/deploy.yml --limit prod --ask-vault-pass` | ğŸš§ **Requires**: AWS instance + domain + DNS |
| **Update code only** | `ansible-playbook playbooks/deploy.yml --limit prod --tags "app_code"` | For production updates |
| **Update config** | `ansible-playbook playbooks/deploy.yml --limit dev --tags "app_config"` | Redeploy environment variables |

### Development Commands (Available Now)
```bash
# Quick development deployment
cd cloud-1/ansible && source ansible_venv.sh
ansible-playbook playbooks/deploy.yml --limit dev --ask-vault-pass --ask-become-pass

# Check your local deployment
docker compose ps
curl -k https://localhost/health
```

## ğŸ›¡ï¸ Security Features

- **SSL/TLS**: Automated Let's Encrypt certificates with auto-renewal
- **Access Control**: IP-based restrictions for admin interfaces
- **Secrets Management**: Ansible Vault encryption for sensitive data
- **Network Isolation**: Docker network segmentation
- **Security Headers**: HSTS, secure ciphers, and CSRF protection

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ”— Technologies Used

- **Containerization**: Docker & Docker Compose
- **Automation**: Ansible with role-based architecture
- **Web Server**: Nginx (Alpine Linux)
- **Application**: WordPress with PHP 8.4
- **Database**: MariaDB (Alpine Linux)
- **SSL**: Let's Encrypt with Certbot + Cloudflare DNS
- **Security**: Ansible Vault for secrets management

---

**ğŸ“– For detailed technical documentation, see [Ansible Documentation](ansible_doc.md) and [Container Documentation](containers_doc.md)**

Made with â¤ï¸ demonstrating modern DevOps practices with Infrastructure as Code